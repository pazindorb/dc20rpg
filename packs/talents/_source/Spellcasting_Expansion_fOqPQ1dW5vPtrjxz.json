{
  "folder": "x8uO1tZjA7FyzFiM",
  "name": "Spellcasting Expansion",
  "type": "feature",
  "img": "icons/magic/control/buff-flight-wings-runes-purple.webp",
  "system": {
    "description": "<p><em>You can only gain this Talent once.</em></p><p>You gain the following benefits:</p><ul><li><p><strong>Combat Training:</strong> You gain Combat Training with Spell Focuses</p></li><li><p><strong>Spell List:</strong> You add 1 Spell Source or 3 Spell Schools of your choice to your Spell List.</p></li><li><p><strong>Spells Known:</strong> You learn 3 Spells from your Spell List.</p></li></ul>",
    "tableName": "",
    "source": "",
    "conditional": {
      "hasConditional": false,
      "condition": "",
      "bonus": 0,
      "useFor": "",
      "name": ""
    },
    "isReaction": false,
    "actionType": "",
    "attackFormula": {
      "checkType": "attack",
      "targetDefence": "precision",
      "rollBonus": 0,
      "combatMastery": true,
      "critThreshold": 20,
      "formulaMod": "",
      "halfDmgOnMiss": false
    },
    "duration": {
      "value": null,
      "type": "",
      "timeUnit": ""
    },
    "range": {
      "normal": null,
      "max": null,
      "unit": ""
    },
    "target": {
      "area": "",
      "count": null,
      "distance": null,
      "invidual": true,
      "type": "",
      "unit": "",
      "width": null
    },
    "check": {
      "canCrit": false,
      "checkKey": "att",
      "contestedKey": "phy",
      "checkDC": 10
    },
    "formulas": {},
    "enhancements": {},
    "copyEnhancements": {
      "copy": false,
      "copyFor": ""
    },
    "save": {
      "type": "phy",
      "dc": null,
      "calculationKey": "spell",
      "addMastery": false
    },
    "costs": {
      "resources": {
        "actionPoint": null,
        "stamina": null,
        "mana": null,
        "health": null,
        "custom": {}
      },
      "charges": {
        "current": null,
        "max": null,
        "maxChargesFormula": "",
        "overriden": false,
        "rechargeFormula": "",
        "reset": "",
        "showAsResource": false
      },
      "otherItem": {
        "itemId": "",
        "amountConsumed": 0,
        "consumeCharge": true
      }
    },
    "featureType": "talent",
    "featureOrigin": "Spellcasting",
    "usesWeapon": {
      "weaponId": "",
      "weaponAttack": false
    },
    "effectsConfig": {
      "toggleable": false,
      "active": false,
      "addToChat": false
    },
    "isResource": false,
    "resource": {
      "name": "",
      "resourceKey": "key",
      "reset": "",
      "values": [
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "macros": {
      "SoUZxlXRaOlK5GEJ": {
        "command": "const clazz = actor.class;\nif (!clazz) return;\nconst school = await DC20.dialog.SimplePopup.open(\"confirm\", {header: \"Spellcasting Expansion\", message: \"Do you want to add 1 Spell Source or 3 Spell Schools\", denyLabel: \"1 Spell Source\", confirmLabel: \"3 Spell Schools\"});\n\nif (school) _selectAndApply(CONFIG.DC20RPG.DROPDOWN_DATA.spellSchools, \"Select 3 Spell Schools\", \"spellSchool\");\nelse _selectAndApply(CONFIG.DC20RPG.DROPDOWN_DATA.spellSources, \"Select Spell Source\", \"spellSource\");\n\nasync function _selectAndApply(options, header, type) {\n  const inputs = [];\n  options = Object.keys(options);\n  for (const option of options) {\n    inputs.push({\n      type: \"checkbox\",\n      label: game.i18n.localize(`dc20rpg.${type}.${option}`)\n    })\n  }\n  const answers = await DC20.dialog.SimplePopup.open(\"input\", {header: header, inputs: inputs});\n  if (!answers) return;\n\n  const changes = {\n    spellSource: [],\n    spellSchool: []\n  }\n  for (let i = 0; i < answers.length; i++) {\n    if (answers[i]) {\n      const key = options[i];\n      changes[type].push(key);\n      clazz.update({[`system.filters.${type}.${key}`]: true});\n    }\n  }\n\n  item.update({[\"flags.dc20rpg.changes\"]: changes});\n}",
        "trigger": "onCreate",
        "disabled": false,
        "name": "Add stuff to Spell List",
        "title": "",
        "global": false
      },
      "Q7Rsq1681rxitEM6": {
        "command": "const clazz = actor.class;\nif (!clazz) return;\nconst changes = item.flags.dc20rpg?.changes;\nif (!changes) return;\n\nfor (const change of changes.spellSource) {\n  clazz.update({[`system.filters.spellSource.${change}`]: false});\n}\n\nfor (const change of changes.spellSchool) {\n  clazz.update({[`system.filters.spellSchool.${change}`]: false});\n}",
        "trigger": "preDelete",
        "disabled": false,
        "name": "Remove stuff from Spell List",
        "title": "",
        "global": false
      }
    }
  },
  "effects": [
    {
      "origin": "Item.d3h86FkJnKf7Xr9v",
      "duration": {
        "rounds": null,
        "startTime": null,
        "seconds": null,
        "combat": null,
        "turns": null,
        "startRound": null,
        "startTurn": null
      },
      "disabled": false,
      "name": "Spellcasting Expansion",
      "img": "icons/magic/control/buff-flight-wings-runes-purple.webp",
      "_id": "NUFJ435N7Ekerblg",
      "type": "base",
      "system": {
        "statusId": "",
        "disableWhen": {
          "mode": "=="
        }
      },
      "changes": [
        {
          "key": "system.combatTraining.spellFocuses",
          "mode": 5,
          "value": "true",
          "priority": null
        },
        {
          "key": "system.known.spells.max",
          "mode": 2,
          "value": "3",
          "priority": null
        }
      ],
      "description": "<p>You gain the following benefits:</p><ul><li><p>You gain Combat Training with Spell Focuses.</p></li><li><p>You add 1 Spell Source or 3 Spell Schools of your choice to your Spell List.</p></li><li><p>You learn 3 Spells from your Spell List.</p></li></ul>",
      "tint": "#ffffff",
      "transfer": true,
      "statuses": [],
      "sort": 0,
      "flags": {
        "dc20rpg": {
          "effectKey": "",
          "disableWhen": {
            "path": "",
            "mode": "==",
            "value": ""
          },
          "requireEnhancement": "",
          "addToChat": false,
          "duration": {
            "useCounter": false,
            "resetWhenEnabled": false,
            "onTimeEnd": ""
          },
          "nonessential": false
        }
      },
      "_stats": {
        "compendiumSource": null,
        "duplicateSource": null,
        "coreVersion": "13.350",
        "systemId": "dc20rpg",
        "systemVersion": "0.9.6.0",
        "createdTime": null,
        "modifiedTime": 1768427032153,
        "lastModifiedBy": "dOcXwrUs2VunZl0y",
        "exportSource": null
      },
      "_key": "!items.effects!fOqPQ1dW5vPtrjxz.NUFJ435N7Ekerblg"
    }
  ],
  "sort": 0,
  "ownership": {
    "default": 0,
    "dOcXwrUs2VunZl0y": 3
  },
  "flags": {},
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": "Item.d3h86FkJnKf7Xr9v",
    "coreVersion": "13.350",
    "systemId": "dc20rpg",
    "systemVersion": "0.10.0.0",
    "createdTime": 1719850606087,
    "modifiedTime": 1768430223799,
    "lastModifiedBy": "dOcXwrUs2VunZl0y",
    "exportSource": null
  },
  "_id": "fOqPQ1dW5vPtrjxz",
  "_key": "!items!fOqPQ1dW5vPtrjxz"
}
