{
  "folder": "6mIFDcv8HNFiTdQU",
  "name": "Fiendish Magic",
  "type": "feature",
  "img": "icons/magic/unholy/projectile-smoke-trail-pink.webp",
  "system": {
    "description": "<p>You learn 1 Spell of your choice from the Arcane Spell List from the Elemental or Enchantment Spell Schools. If the Spell deals damage, then it must be the same damage type as your <strong>Fiendish</strong> damage.</p><p>Once per <strong>LR</strong>, you can cast the chosen Spell spending 1 less<strong> MP</strong> than normal (minimum of<strong> 0 MP</strong>).</p><p>The Spells total <strong>MP </strong>cost (before all reductions) still cannot exceed your <strong>Mana Spend Limit</strong>.</p>",
    "tableName": "",
    "source": "",
    "conditional": {
      "hasConditional": false,
      "condition": "",
      "bonus": 0,
      "useFor": "",
      "name": "",
      "connectedToEffects": false
    },
    "isReaction": false,
    "actionType": "",
    "attackFormula": {
      "rangeType": "melee",
      "checkType": "attack",
      "targetDefence": "precision",
      "rollBonus": 0,
      "combatMastery": true,
      "critThreshold": 20,
      "formulaMod": "",
      "halfDmgOnMiss": false
    },
    "duration": {
      "value": null,
      "type": "",
      "timeUnit": ""
    },
    "range": {
      "normal": null,
      "max": null,
      "unit": ""
    },
    "target": {
      "count": null,
      "invidual": true,
      "type": "",
      "areas": {
        "default": {
          "area": "",
          "distance": null,
          "width": null,
          "unit": "",
          "difficult": ""
        }
      },
      "area": "",
      "distance": null,
      "unit": "",
      "width": null
    },
    "check": {
      "canCrit": false,
      "checkKey": "att",
      "contestedKey": "phy",
      "checkDC": 10,
      "failEffect": ""
    },
    "formulas": {},
    "enhancements": {
      "RkXPOoVRpvSZKUkJ": {
        "name": "Fiendish Magic",
        "number": 0,
        "resources": {
          "actionPoint": null,
          "health": null,
          "mana": -1,
          "stamina": null,
          "custom": {},
          "grit": null,
          "restPoints": null,
          "ap": null
        },
        "charges": {
          "consume": true,
          "fromOriginal": true,
          "originalId": "XHeYmJkroeegUlXf",
          "subtract": 1
        },
        "modifications": {
          "hasAdditionalFormula": false,
          "additionalFormula": "",
          "addsNewFormula": false,
          "formula": {
            "formula": "",
            "type": "",
            "category": "damage",
            "fail": false,
            "failFormula": "",
            "each5": false,
            "each5Formula": "",
            "dontMerge": false,
            "overrideDefence": "",
            "perTarget": false
          },
          "overrideDamageType": false,
          "damageType": "",
          "addsNewRollRequest": false,
          "rollRequest": {
            "category": "save",
            "saveKey": "",
            "contestedKey": "",
            "dcCalculation": "martial",
            "dc": 0,
            "addMasteryToDC": false,
            "respectSizeRules": false
          },
          "rollLevelChange": false,
          "rollLevel": {
            "type": "adv",
            "value": 1
          },
          "addsRange": false,
          "bonusRange": {
            "melee": null,
            "normal": null,
            "max": null
          },
          "modifiesCoreFormula": false,
          "changeManaSpendLimit": -1,
          "coreFormulaModification": "-1",
          "overrideTargetDefence": false,
          "targetDefenceType": "area",
          "addsAgainstStatus": false,
          "againstStatus": {
            "id": "",
            "supressFromChatMessage": false,
            "untilYourNextTurnStart": false,
            "untilYourNextTurnEnd": false,
            "untilTargetNextTurnStart": false,
            "untilTargetNextTurnEnd": false,
            "untilFirstTimeTriggered": false,
            "forOneMinute": false,
            "repeatedSave": false,
            "repeatedSaveKey": "phy"
          },
          "addsEffect": null,
          "macros": {
            "preItemRoll": "",
            "postItemRoll": ""
          },
          "changeStaminaSpendLimit": null
        },
        "description": "<p><span style=\"font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif\">Once per <strong style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);\">LR</strong>, you can cast the chosen Spell spending 1 less<strong style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);\"> MP</strong> than normal (minimum of<strong style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);\"> 0</strong> <strong style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);\">MP</strong>).</span></p><p style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track); margin: 0.5em 0px; color: rgb(25, 24, 19); font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; text-align: start\"><span style=\"font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif\">The Spells total <strong style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);\">MP </strong>cost (before all reductions) still cannot exceed your <strong style=\"box-sizing: border-box; user-select: text; scrollbar-width: thin; scrollbar-color: var(--color-scrollbar) var(--color-scrollbar-track);\">Mana Spend Limit</strong>.</span></p>",
        "hide": false,
        "key": "RkXPOoVRpvSZKUkJ",
        "sourceItemId": "XHeYmJkroeegUlXf",
        "sourceItemName": "Fiendish Magic",
        "sourceItemImg": "icons/magic/unholy/projectile-smoke-trail-pink.webp",
        "active": false
      }
    },
    "copyEnhancements": {
      "copy": true,
      "copyFor": "name=\"SELECTED SPELL NAME\""
    },
    "save": {
      "type": "phy",
      "dc": null,
      "calculationKey": "spell",
      "addMastery": false,
      "failEffect": ""
    },
    "costs": {
      "resources": {
        "actionPoint": null,
        "stamina": null,
        "mana": null,
        "health": null,
        "custom": {}
      },
      "charges": {
        "current": 1,
        "max": null,
        "maxChargesFormula": "1",
        "overriden": false,
        "rechargeFormula": "",
        "reset": "long",
        "showAsResource": false
      },
      "otherItem": {
        "itemId": "",
        "amountConsumed": 0,
        "consumeCharge": true
      }
    },
    "featureType": "ancestry",
    "featureOrigin": "Fiendborn",
    "usesWeapon": {
      "weaponId": "",
      "weaponAttack": false
    },
    "effectsConfig": {
      "toggleable": false,
      "active": false,
      "addToChat": false
    },
    "isResource": false,
    "resource": {
      "name": "",
      "resourceKey": "key",
      "reset": "",
      "values": [
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "choicePointCost": 2,
    "hasAdvancement": true,
    "advancements": {
      "default": {
        "name": "Fiendish Magic",
        "allowToAddItems": true,
        "customTitle": "Fiendish Magic - You learn 1 Spell from the Arcane Spell List from the Elemental or Enchantment Spell Schools",
        "items": {},
        "addItemsOptions": {
          "itemLimit": 1,
          "itemType": "spell",
          "helpText": "Add Fiendish Magic Spell",
          "preFilters": "{\"spellSource\": {\"arcane\": true, \"divine\": false, \"primal\": false}}"
        },
        "macro": "if (!advancement.items) {\n  ui.notifications.error(\"Fiendish Magic Spell not found - Add it manually by running on demand macro\");\n  return;\n}\nconst items = Object.values(advancement.items);\nconst spell = items[0];\n\nif (!spell) {\n  ui.notifications.error(\"Fiendish Magic Spell not found - Add it manually by running on demand macro\");\n  return;\n}\nelse {\n  const fiendishMagic = actor.getItemByKey(\"fiendishMagic\");\n  if (fiendishMagic) {\n    fiendishMagic.update({\n      [\"system.copyEnhancements.copyFor\"]: `id=[\"${spell.createdItemId}\"]`,\n      [\"system.shortInfo\"]: `Selected Spell: ${spell.name}`,\n      [\"flags.dc20rpg.currentSpellId\"]: spell.createdItemId\n    });\n  }\n}",
        "doNotAddToKnownLimit": true,
        "key": "default"
      }
    },
    "macros": {
      "gswH3bkqZ9LB8sU1": {
        "name": "Change Fiendish Magic Spell",
        "trigger": "onDemand",
        "command": "const options = actor.getAllItemsWithType([\"spell\"], [], true);\nconst spellId = await DC20.dialog.SimplePopup.select(\"Select Fiendish Magic Spell\", options);\nif (!spellId) return;\n\nconst currentSpellId = item.flags.dc20rpg.currentSpellId;\nif (currentSpellId === spellId) return;\n\nconst currentSpell = actor.items.get(currentSpellId);\nif (currentSpell) currentSpell.update({[\"system.knownLimit\"]: true});\nconst newSpell = actor.items.get(spellId);\nif (newSpell) newSpell.update({[\"system.knownLimit\"]: false});\n\nitem.update({\n  [\"system.copyEnhancements.copyFor\"]: `id=[\"${spellId}\"]`,\n  [\"system.shortInfo\"]: `Selected Spell: ${options[spellId]}`,\n  [\"flags.dc20rpg.currentSpellId\"]: spellId\n});",
        "disabled": false,
        "title": "Change Fiendish Magic Spell"
      }
    },
    "itemKey": "fiendishMagic",
    "featureSourceItem": "fiendborn",
    "requirements": {
      "level": 0
    }
  },
  "effects": [],
  "sort": 200000,
  "ownership": {
    "default": 0,
    "dOcXwrUs2VunZl0y": 3
  },
  "flags": {},
  "_stats": {
    "compendiumSource": "Item.NKuUuUyr0TkwO37A",
    "duplicateSource": "Item.NKuUuUyr0TkwO37A",
    "coreVersion": "13.350",
    "systemId": "dc20rpg",
    "systemVersion": "0.10.0.0",
    "createdTime": 1720100284317,
    "modifiedTime": 1768418815543,
    "lastModifiedBy": "dOcXwrUs2VunZl0y",
    "exportSource": null
  },
  "_id": "XHeYmJkroeegUlXf",
  "_key": "!items!XHeYmJkroeegUlXf"
}
